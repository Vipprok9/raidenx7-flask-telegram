<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RaidenX7 • Web Chat → Telegram</title>
  <style>
    body{font-family:system-ui,Arial;margin:24px;max-width:720px}
    #box{border:1px solid #ddd;border-radius:12px;padding:12px;height:320px;overflow:auto;background:#fafafa}
    .msg{margin:6px 0;padding:8px 12px;border-radius:10px;display:inline-block;max-width:85%}
    .me{background:#dbeafe}.bot{background:#dcfce7}
    .row{display:flex;gap:8px;margin-top:12px}
    input{flex:1;padding:12px;border:1px solid #ccc;border-radius:10px}
    button{padding:12px 16px;border-radius:10px;border:0;background:#0ea5e9;color:white;cursor:pointer}
  </style>
</head>
<body>
  <h1>Web Chat → Telegram (auto-reply)</h1>
  <p>Nhập câu hỏi, bot sẽ gửi sang Telegram và trả lời cơ bản ngay tại đây.</p>
  <div id="box"></div>
  <div class="row">
    <input id="msg" placeholder="Nhập tin nhắn..." />
    <button id="send">Gửi</button>
  </div>
  <div id="status" style="margin-top:8px;color:#888"></div>

<script>
const box = document.getElementById('box');
const input = document.getElementById('msg');
const btn = document.getElementById('send');
const statusEl = document.getElementById('status');

function add(side, text){
  const d=document.createElement('div');
  d.className='msg ' + (side==='me'?'me':'bot');
  d.textContent=text;
  box.appendChild(d); box.appendChild(document.createElement('br'));
  box.scrollTop = box.scrollHeight;
}

async function send(){
  const text = input.value.trim();
  if(!text) return;
  add('me', text);
  input.value='';
  statusEl.textContent = 'Đang gửi…';
  try{
    const r = await fetch('/send', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({text})
    });
    const j = await r.json();
    if(j.ok){
      add('bot', j.reply || 'Đã chuyển cho admin.');
      statusEl.textContent = 'OK';
    }else{
      statusEl.textContent = 'Lỗi: ' + (j.error || 'không rõ');
    }
  }catch(e){
    statusEl.textContent = 'Không kết nối được server';
  }
}

btn.addEventListener('click', send);
input.addEventListener('keydown', e=>{ if(e.key==='Enter') send(); });
</script>
</body>
</html>
